@model Permission.WebManager.Lib.WebModel.SystemManager.RoleWebM
@{
    Layout = "~/Views/Shared/_ShowDialog.cshtml";
 

}

<script src="~/Content/lib/zTree_v3/js/jquery.ztree.all-3.5.min.js"></script>
<link href="~/Content/lib/zTree_v3/css/zTreeStyle/zTreeStyle.css" rel="stylesheet" />
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
            </div>
            <div class="panel-body">
                @using (Html.BeginForm("form1"))
                {
                    @Html.AntiForgeryToken()

                    <div class="row">
                        <table class="detail_table">
                            <tr>
                                <td >
                                    <label>角色名：</label></td>
                                <td>@Html.TextBoxFor(c => c.role_name, new { style = "width:40%;" })
                                    @Html.ValidationMessageFor(c => c.role_name)
                                     @Html.HiddenFor(c => c.role_id)
                                </td>
                                <td>
                                    <label>是否有效：</label></td>
                                <td>@Html.RadioButtonTrueOrFlaseReadonlyFor(c => c.role_status, false, null)

                                </td>
                            </tr>
                            <tr>
                                <td></td>
                            </tr>
                            <tr>
                                <td>
                                    <label>权限设置：</label></td>
                                <td>
                                    <div class="zTreeDemoBackground left">
                                        <ul id="treeDemo" class="ztree"></ul>
                                    </div>
                                    <script type="text/javascript">
		<!--
    var setting = {
        check: {
            enable: true
        },
        data: {
            simpleData: {
                enable: true
            }
        }
    };

    var zNodes = @MvcHtmlString.Create(ViewBag.Tree);



    $(document).ready(function () {
        jQuery("#Form1").validate();
        $.fn.zTree.init($("#treeDemo"), setting, zNodes);
        setting.check.chkboxType = { "Y": "ps", "N": "ps" };
    });
    function save() {
        var treeObj = $.fn.zTree.getZTreeObj("treeDemo");
        var nodes = treeObj.getCheckedNodes(true);
        var idlist = "";
        for (var i = 0; i < nodes.length; i++) {
            idlist = idlist + "," + nodes[i].id;
        }
        $("#power").val(idlist);
        if (idlist != "")
            return true;
        alert('请选择权限!');
        return false;
        //  document.forms[0].submit();
    }
    //-->
                                    </script>
                                    @Html.Hidden("power")
                                </td>

                            </tr>
                            <tr>
                                <td></td>
                            </tr>

                        </table>
                        <div class="form-group text-center">
                            <button type="submit" class="btn btn-default" onclick="return save();">保存</button>
                            <button type="button" class="btn btn-default" onclick=" parent.layer.closeAll('iframe'); ">关闭</button>
                        </div>
                    </div>
                }


                <!-- /.row (nested) -->
            </div>
            <!-- /.panel-body -->
        </div>
        <!-- /.panel -->
    </div>
    <!-- /.col-lg-12 -->
</div>
